<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Server Monitor</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
<div class="container">

    <h1>SERVER MONITOR</h1>

    <!-- 시스템 상태 -->
    <div class="card">
        <p>CPU :
            <span class="{{ cpu_class }}">{{ cpu }}%</span>
        </p>
        <p>MEMORY :
            <span class="{{ memory_class }}">{{ memory }}%</span>
        </p>
        <p>DISK :
            <span class="good">{{ disk }}%</span>
        </p>
        <p>UPTIME :
            <span>{{ uptime }}</span>
        </p>
    </div>

    <!-- 서비스 상태 -->
    <div class="card">
        <h2>SERVICES</h2>
        {% for name, status in services.items() %}
        <p>
            <span class="dot 
                {% if 'zombie' in status.lower() or 'idle' in status.lower() %}
                    warn
                {% elif status.lower().startswith('active') %}
                    on
                {% else %}
                    off
                {% endif %}">
            </span>
            {{ name }} [ {{ status | upper }} ]
        </p>
        {% endfor %}
    </div>

    <!-- 로그 콘솔 -->
    <div class="card">
        <h2>LOG CONSOLE</h2>
        <p style="font-size:9px; color:#999;">
            SOURCE : {{ log_source }}
        </p>

        <div class="console">
            {% for line in logs %}
            {{ line }}
            {% endfor %}
        </div>
    </div>


    <!-- 프로세스 상태 -->
    <div class="card process-card">
        <h2>PROCESSES</h2>

        {% for p in processes %}
        <p>
            <!-- 상태 도트 -->
            {% if p.status_summary == 'OK' %}
                <span class="dot on"></span>
            {% elif p.status_summary == 'WARN' %}
                <span class="dot warn"></span>
            {% else %}
                <span class="dot off"></span>
            {% endif %}

            {{ p.name }} (PID {{ p.pid }})
        </p>

        <p style="font-size:9px; margin-left:18px; line-height: 1.6;">
            CPU {{ p.cpu }}% |
            MEM {{ p.memory }}% |
            USER {{ p.user }}
        </p>

        {% if p.ports %}
        <p style="font-size:9px; margin-left:18px; line-height: 1.6;">
            PORT : {{ p.ports | join(', ') }}
        </p>
        {% endif %}

        {% if p.warnings %}
        <p style="font-size:9px; margin-left:18px; line-height: 1.6;" class="bad">
            ⚠ {{ p.warnings | join(', ') }}
        </p>
        {% endif %}

        <p style="font-size:9px; margin-left:18px; line-height: 1.6; color:#999;">
            {{ p.explain }}
        </p>

        <hr style="border:1px dashed #00ff9c; margin:10px 0;">
        {% endfor %}
    </div>

</div>
</body>
</html>
